#include<stdio.h>
#include<stdlib.h>
#include<string.h>
#include<dirent.h>

int main(int *argc, char *argv[])
{
	DIR *diretorio;
	struct dirent *entrada;
	struct lista_arq
	{
		char nomearq[40];
		struct lista_arq *proximo;
	} inicio, *nodo, *novo, *anterior;

	if ((diretorio = opendir(argv[1])) == NULL)
		printf("Erro ao abrir o arquivo %s.\n", argc[1]);

	else
	{
		inicio.proximo = NULL;
		while (entrada = readdir(diretorio))
		{
			// encontra a posição correta.
			anterior = &inicio;
			nodo = inicio.proximo;
			while ((nodo) && (strcmp(entrada, nodo->nomearq) > 0))
			{
				nodo = nodo->proximo;
				anterior = anterior->proximo;
			}
			novo = (struct lista_arq *)malloc(sizeof(struct lista_arq));
			if (novo == NULL)
			{
				printf("Memoria insuficiente para armazenar a lista.\n");
				exit(1);
			}

			novo->proximo = nodo;
			anterior->proximo = novo;
			strcpy(novo->nomearq, entrada);
		}

		closedir(diretorio);
		nodo = inicio.proximo;
		while (nodo)
		{
			printf("%s\n", nodo->nomearq);
			nodo = nodo->proximo;
		}
	}
}